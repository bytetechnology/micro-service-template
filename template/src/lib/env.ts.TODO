import dotenv from 'dotenv';
import path from 'path';
import pkgDir from 'pkg-dir';

let { ENV_FILE = '' } = process.env;

if (ENV_FILE && !path.isAbsolute(ENV_FILE)) {
  const ROOT_DIR = pkgDir.sync(__dirname);
  ENV_FILE = path.join(ROOT_DIR, ENV_FILE);
}

const { error, parsed } = dotenv.config({ path: ENV_FILE });

if (error) {
  console.error(`Unable to parse .env file: "${ENV_FILE}"`, error);
  process.exit(9);
}

// TODO validate parsed using joiful

const env = parsed;

export { env };